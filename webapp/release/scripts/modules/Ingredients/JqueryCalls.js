"use strict";define(["jquery","vendor/bootstrap/bootstrap-alert","vendor/bootstrap/bootstrap-button","vendor/bootstrap/bootstrap-modal","vendor/bootstrap/bootstrap-combined","vendor/twitter-typeahead/typeahead","mustache","underscore"],function(e,t,n,i,a,r,o,d){var s=function(){e("#addNewIngredientFormModal").modal({show:!1,keyboard:!1}),e("#addNewIngredientButton").click(function(){e("#addNewIngredientFormModal").modal("show")}),e("#addIngredientFormSubmit").click(function(){e("#formComponent").trigger({type:"addFormSubmit"}),e("#addIngredientFormSubmit").button("loading"),e("#addIngredientModalClose").button("loading"),e("#addIngredientFormClear").button("loading")}),e("#calculatorComponent").trigger({type:"nextDependencyLoaded"})},l=function(){var t=e("#addIngredientmodalForm").serialize(),n=(new Date).getTime();t+="&CACHEBANG="+n,e.ajax({type:"GET",url:"api/addIngredient",data:t,success:function(t){e("#formComponent").trigger({type:"dataReceived",returnData:t})},error:function(){console.log("Error in request")}})},u=function(t){e("#formTimeStamp").val(t.timestamp)},c=function(t){t.returnData.init||(console.log(t),e("#calculatorComponent").trigger({type:"dataReceived",returnData:t.returnData}),e("#addIngredientFormSubmit").button("reset"),e("#addIngredientModalClose").button("reset"),e("#addIngredientFormClear").button("reset"),t.returnData.addedStatus.success?(e("#formAlertArea").html(o.render(a.formSuccess)),e("#ingredientBoxSuccessAlert").alert()):(e("#formAlertArea").html(o.render(a.formError)),e("#ingredientBoxErrorAlert").alert()))},m=function(){e("#ingredientTypeahead").remove(),e("#inputWarning").remove(),e("#inputControls").html(o.render(a.typeAhead,{})),e("#ingredientTypeahead").typeahead({prefetch:"api/typeaheadHackInit"})},p=function(t,n){console.log(t),e("#itemList").append(o.render(a.addItem,{data:t,index:n})),e("#removeItem"+n).click(function(){e("#calculatorComponent").trigger({type:"itemRemoved",index:n})}),e("#itemQuantity"+n).on("input",function(){e("#calculatorComponent").trigger({type:"quantitiesChanged",index:n,removed:!1})})},f=function(){e("#warningGroup").addClass("error"),e("#inputWarning").html("This item is already present")},v=function(t){e("#addedItem"+t).remove(),e("#calculatorComponent").trigger({type:"quantitiesChanged",index:t,removed:!0})},g=function(){var t=e(".inputQuantity");return d.map(t,function(e){return isNaN(parseFloat(e.value))?0:0>parseFloat(e.value)?0:parseFloat(e.value)})},b=function(t){console.log(t),e("#totalPriceValue").html(t.toFixed(2))},h=function(t,n){var i=parseFloat(e("#itemQuantity"+t)[0].value);(0>i||isNaN(i))&&(i=0);var a=i*n;e("#itemValue"+t).html(a.toFixed(2))};return{FormInit:s,FormSubmitForm:l,FormReceiveFormData:c,FormSetTimeStamp:u,CalculatorsetTypeAhead:m,CalculatoraddItem:p,CalculatoraddItemError:f,CalculatorremoveItem:v,CalculatorgetQuantityValues:g,CalculatorrenderTotalCost:b,CalculatorrenderTotalCostChange:h}});
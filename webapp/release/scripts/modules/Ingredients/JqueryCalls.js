(function(){"use strict";define(["jquery","vendor/bootstrap/bootstrap-alert","vendor/bootstrap/bootstrap-button","vendor/bootstrap/bootstrap-modal","vendor/bootstrap/bootstrap-combined","vendor/twitter-typeahead/typeahead","mustache","underscore"],function(e,t,n,r,i,a,o,l){var d,s,u,c,m,p,f,v,g,b,h;return v=function(){return e("#addNewIngredientFormModal").modal({show:!1,keyboard:!1}),e("#addNewIngredientButton").click(function(){return e("#addNewIngredientFormModal").modal("show")}),e("#addIngredientFormSubmit").click(function(){return e("#formComponent").trigger({type:"addFormSubmit"}),e("#addIngredientFormSubmit").button("loading"),e("#addIngredientModalClose").button("loading"),e("#addIngredientFormClear").button("loading")}),e("#calculatorComponent").trigger({type:"nextDependencyLoaded"})},h=function(){var t,n;return n=e("#addIngredientmodalForm").serialize(),t=(new Date).getTime(),n+="&CACHEBANG="+t,e.ajax({type:"GET",url:"api/addIngredient",data:n,success:function(t){return e("#formComponent").trigger({type:"dataReceived",returnData:t})},error:function(){return console.log("Error in request")}})},b=function(t){return e("#formTimeStamp").val(t.timestamp)},g=function(t){return t.returnData.init?void 0:(console.log(t),e("#calculatorComponent").trigger({type:"dataReceived",returnData:t.returnData}),e("#addIngredientFormSubmit").button("reset"),e("#addIngredientModalClose").button("reset"),e("#addIngredientFormClear").button("reset"),t.returnData.addedStatus.success?(e("#formAlertArea").html(o.render(i.formSuccess)),e("#ingredientBoxSuccessAlert").alert()):(e("#formAlertArea").html(o.render(i.formError)),e("#ingredientBoxErrorAlert").alert()))},f=function(){return e("#ingredientTypeahead").remove(),e("#inputWarning").remove(),e("#inputControls").html(o.render(i.typeAhead,{})),e("#ingredientTypeahead").typeahead({prefetch:"api/typeaheadHackInit"})},d=function(t,n){return console.log(t),e("#itemList").append(o.render(i.addItem,{data:t,index:n})),e("#removeItem"+n).click(function(){return e("#calculatorComponent").trigger({type:"itemRemoved",index:n})}),e("#itemQuantity"+n).on("input",function(){return e("#calculatorComponent").trigger({type:"quantitiesChanged",index:n,removed:!1})})},s=function(){return e("#warningGroup").addClass("error"),e("#inputWarning").html("This item is already present")},c=function(t){return e("#addedItem"+t).remove(),e("#calculatorComponent").trigger({type:"quantitiesChanged",index:t,removed:!0})},u=function(){var t;return t=e(".inputQuantity"),l.map(t,function(e){return isNaN(parseFloat(e.value))?0:0>parseFloat(e.value)?0:parseFloat(e.value)})},m=function(t){return console.log(t),e("#totalPriceValue").html(t.toFixed(2))},p=function(t,n){var r,i;return i=parseFloat(e("#itemQuantity"+t)[0].value),(0>i||isNaN(i))&&(i=0),r=i*n,e("#itemValue"+t).html(r.toFixed(2))},{FormInit:v,FormSubmitForm:h,FormReceiveFormData:g,FormSetTimeStamp:b,CalculatorsetTypeAhead:f,CalculatoraddItem:d,CalculatoraddItemError:s,CalculatorremoveItem:c,CalculatorgetQuantityValues:u,CalculatorrenderTotalCost:m,CalculatorrenderTotalCostChange:p}})}).call(this);
define(["assets/js/components/flight/lib/component","src/modules/Ingredients/JqueryCalls"],function(e,t){function n(){this.defaultAttrs({selectedItems:[],allItems:[],quantities:[],lastTimeStamp:0}),this.setData=function(e){console.log(e.returnData),this.attr.lastTimeStamp=e.returnData.lastTimeStamp,this.attr.allItems=this.attr.allItems.concat(e.returnData.updatedData),e.returnData.init||e.returnData.addedStatus.success,t.CalculatorsetTypeAhead(this.attr.lastTimeStamp,this.attr.allItems)},this.addItem=function(e){if(-1==this.attr.selectedItems.indexOf(e.index)){var n=e.index,r=this.attr.allItems[n];this.attr.selectedItems.push(e.index),t.CalculatoraddItem(r,n)}else t.CalculatoraddItemError()},this.removeItem=function(e){var n=this.attr.selectedItems.indexOf(e.index);this.attr.selectedItems.splice(n,1),t.CalculatorremoveItem(e.index)},this.setQuantities=function(e){for(var n=t.CalculatorgetQuantityValues(),r=0,i=0;this.attr.selectedItems.length>i;i++){var o=this.attr.selectedItems[i],a=this.attr.allItems[o].PRICE,s=a*n[i];isNaN(s)||(r+=s)}console.log(r),t.CalculatorrenderTotalCost(r),e.removed||t.CalculatorrenderTotalCostChange(e.index,this.attr.allItems[e.index].PRICE)},this.Init=function(){this.attr.selectedItems=[],this.attr.allItems=[],this.attr.quantities=[],this.attr.lastTimeStamp=0},this.after("initialize",function(){this.Init(),this.on("nextDependencyLoaded",t.CalculatorInit),this.on("dataReceived",this.setData),this.on("newItemAdded",this.addItem),this.on("itemRemoved",this.removeItem),this.on("quantitiesChanged",this.setQuantities)})}return{calculatorComponent:e(n)}});
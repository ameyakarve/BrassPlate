define(["jquery","assets/js/components/bootstrap/js/bootstrap-combined","assets/js/components/typeahead/dist/typeahead","mustache","underscore"],function(t,e,n,i,r){var o=function(){t("#addNewIngredientFormModal").modal({show:!1,keyboard:!1}),t("#addNewIngredientButton").click(function(){t("#addNewIngredientFormModal").modal("show")}),t("#addIngredientFormSubmit").click(function(){t("#formComponent").trigger({type:"addFormSubmit"}),t("#addIngredientFormSubmit").button("loading"),t("#addIngredientModalClose").button("loading"),t("#addIngredientFormClear").button("loading")}),t("#calculatorComponent").trigger({type:"nextDependencyLoaded"})},s=function(){var e=t("#addIngredientmodalForm").serialize(),n=(new Date).getTime();e+="&CACHEBANG="+n,t.ajax({type:"GET",url:"api/addIngredient",data:e,success:function(e){t("#formComponent").trigger({type:"dataReceived",returnData:e})},error:function(){console.log("Error in request")}})},a=function(e){t("#formTimeStamp").val(e.timestamp)},u=function(n){n.returnData.init||(console.log(n),t("#calculatorComponent").trigger({type:"dataReceived",returnData:n.returnData}),t("#addIngredientFormSubmit").button("reset"),t("#addIngredientModalClose").button("reset"),t("#addIngredientFormClear").button("reset"),n.returnData.addedStatus.success?(t("#formAlertArea").html(i.render(e.formSuccess)),t("#ingredientBoxSuccessAlert").alert()):(t("#formAlertArea").html(i.render(e.formError)),t("#ingredientBoxErrorAlert").alert()))},c=function(){t("#ingredientTypeahead").remove(),t("#inputWarning").remove(),t("#inputControls").html(i.render(e.typeAhead,{})),t("#ingredientTypeahead").typeahead({prefetch:"api/typeaheadHackInit"})},l=function(n,r){console.log(n),t("#itemList").append(i.render(e.addItem,{data:n,index:r})),t("#removeItem"+r).click(function(){t("#calculatorComponent").trigger({type:"itemRemoved",index:r})}),t("#itemQuantity"+r).on("input",function(){t("#calculatorComponent").trigger({type:"quantitiesChanged",index:r,removed:!1})})},d=function(){t("#warningGroup").addClass("error"),t("#inputWarning").html("This item is already present")},h=function(e){t("#addedItem"+e).remove(),t("#calculatorComponent").trigger({type:"quantitiesChanged",index:e,removed:!0})},f=function(){var e=t(".inputQuantity");return r.map(e,function(t){return isNaN(parseFloat(t.value))?0:0>parseFloat(t.value)?0:parseFloat(t.value)})},p=function(e){console.log(e),t("#totalPriceValue").html(e.toFixed(2))},m=function(e,n){var i=parseFloat(t("#itemQuantity"+e)[0].value);(0>i||isNaN(i))&&(i=0);var r=i*n;t("#itemValue"+e).html(r.toFixed(2))};return{FormInit:o,FormSubmitForm:s,FormReceiveFormData:u,FormSetTimeStamp:a,CalculatorsetTypeAhead:c,CalculatoraddItem:l,CalculatoraddItemError:d,CalculatorremoveItem:h,CalculatorgetQuantityValues:f,CalculatorrenderTotalCost:p,CalculatorrenderTotalCostChange:m}});
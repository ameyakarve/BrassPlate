// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

"undefined"==typeof process&&(process={}),function(){process.EventEmitter=process.EventEmitter||function(){};var e=exports.EventEmitter=process.EventEmitter,t=Array.isArray,n=10;e.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},e.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||t(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var n=this._events[e];if(!n)return!1;if("function"==typeof n){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:var r=Array.prototype.slice.call(arguments,1);n.apply(this,r)}return!0}if(t(n)){for(var r=Array.prototype.slice.call(arguments,1),i=n.slice(),o=0,s=i.length;s>o;o++)i[o].apply(this,r);return!0}return!1},e.prototype.addListener=function(e,r){if("function"!=typeof r)throw Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,r),this._events[e])if(t(this._events[e])){if(this._events[e].push(r),!this._events[e].warned){var i;i=void 0!==this._events.maxListeners?this._events.maxListeners:n,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}else this._events[e]=[this._events[e],r];else this._events[e]=r;return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(e,t){function n(){r.removeListener(e,n),t.apply(this,arguments)}var r=this;return n.listener=t,r.on(e,n),this},e.prototype.removeListener=function(e,n){if("function"!=typeof n)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var r=this._events[e];if(t(r)){for(var i=-1,o=0,s=r.length;s>o;o++)if(r[o]===n||r[o].listener&&r[o].listener===n){i=o;break}if(0>i)return this;r.splice(i,1),0==r.length&&delete this._events[e]}else(r===n||r.listener&&r.listener===n)&&delete this._events[e];return this},e.prototype.removeAllListeners=function(e){return e&&this._events&&this._events[e]&&(this._events[e]=null),this},e.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),t(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}();
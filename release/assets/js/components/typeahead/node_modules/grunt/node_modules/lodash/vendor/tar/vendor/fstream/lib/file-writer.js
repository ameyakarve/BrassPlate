function FileWriter(e){var t=this;if(!(t instanceof FileWriter))throw Error("FileWriter must be called as constructor.");if("File"!==e.type||!e.File)throw Error("Non-file type "+e.type);t._buffer=[],t._bytesWritten=0,Writer.call(this,e)}module.exports=FileWriter;var fs=require("../../graceful-fs/graceful-fs.js"),mkdir=require("../../mkdirp"),Writer=require("./writer.js"),inherits=require("../../inherits/inherits.js"),EOF={};inherits(FileWriter,Writer),FileWriter.prototype._create=function(){var e=this;if(!e._stream){var t={};e.props.flags&&(t.flags=e.props.flags),t.mode=Writer.filemode,e._old&&e._old.blksize&&(t.bufferSize=e._old.blksize),e._stream=fs.createWriteStream(e._path,t),e._stream.on("open",function(){e.ready=!0,e._buffer.forEach(function(t){t===EOF?e._stream.end():e._stream.write(t)}),e.emit("ready")}),e._stream.on("drain",function(){e.emit("drain")}),e._stream.on("close",function(){e._finish()})}},FileWriter.prototype.write=function(e){var t=this;if(t._bytesWritten+=e.length,!t.ready)return t._buffer.push(e),!1;var n=t._stream.write(e);return n||t._stream._queue&&2>=t._stream._queue.length},FileWriter.prototype.end=function(e){var t=this;return e&&t.write(e),t.ready?t._stream.end():(t._buffer.push(EOF),!1)},FileWriter.prototype._finish=function(){var e=this;"number"==typeof e.size&&e._bytesWritten!=e.size&&e.error("Did not get expected byte count.\nexpect: "+e.size+"\n"+"actual: "+e._bytesWritten),Writer.prototype._finish.call(e)};
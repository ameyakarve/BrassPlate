// Underscore.string
// (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
// Underscore.strings is freely distributable under the terms of the MIT license.
// Documentation: https://github.com/epeli/underscore.string
// Some code is borrowed from MooTools and Alexandru Marasteanu.

// Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>

(function(e){var t=String.prototype.trim,n=String.prototype.trimRight,r=String.prototype.trimLeft,i=function(e){return 1*e||0},o=function(e,t,n){e+="",t=~~t;for(var r=[];t>0;r[--t]=e);return r.join(null==n?"":n)},a=function(e){return Array.prototype.slice.call(e)},s=function(e){return null!=e?"["+p.escapeRegExp(""+e)+"]":"\\s"},u={lt:"<",gt:">",quot:'"',apos:"'",amp:"&"},l={};for(var c in u)l[u[c]]=c;var f=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var t=o,n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,r){var i,o,a,s,u,l,c,p=1,d=n.length,h="",g=[];for(o=0;d>o;o++)if(h=e(n[o]),"string"===h)g.push(n[o]);else if("array"===h){if(s=n[o],s[2])for(i=r[p],a=0;s[2].length>a;a++){if(!i.hasOwnProperty(s[2][a]))throw Error(f('[_.sprintf] property "%s" does not exist',s[2][a]));i=i[s[2][a]]}else i=s[1]?r[s[1]]:r[p++];if(/[^s]/.test(s[8])&&"number"!=e(i))throw Error(f("[_.sprintf] expecting number but found %s",e(i)));switch(s[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=s[7]?i.toExponential(s[7]):i.toExponential();break;case"f":i=s[7]?parseFloat(i).toFixed(s[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i+="")&&s[7]?i.substring(0,s[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(s[8])&&s[3]&&i>=0?"+"+i:i,l=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",c=s[6]-(i+"").length,u=s[6]?t(l,c):"",g.push(s[5]?i+u:u+i)}return g.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw Error("[_.sprintf] huh?");if(n[2]){i|=1;var o=[],a=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw Error("[_.sprintf] huh?");for(o.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))o.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw Error("[_.sprintf] huh?");o.push(s[1])}n[2]=o}else i|=2;if(3===i)throw Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");r.push(n)}t=t.substring(n[0].length)}return r},n}(),p={VERSION:"2.2.0rc",isBlank:function(e){return/^\s*$/.test(e)},stripTags:function(e){return(""+e).replace(/<\/?[^>]+>/g,"")},capitalize:function(e){return e+="",e.charAt(0).toUpperCase()+e.substring(1)},chop:function(e,t){e+="",t=~~t||e.length;for(var n=[],r=0;e.length>r;r+=t)n.push(e.slice(r,r+t));return n},clean:function(e){return p.strip(e).replace(/\s+/g," ")},count:function(e,t){return e+="",t+="",e.split(t).length-1},chars:function(e){return(""+e).split("")},escapeHTML:function(e){return(""+e).replace(/[&<>"']/g,function(e){return"&"+l[e]+";"})},unescapeHTML:function(e){return(""+e).replace(/\&([^;]+);/g,function(e,t){var n;return t in u?u[t]:(n=t.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(n[1],16)):(n=t.match(/^#(\d+)$/))?String.fromCharCode(~~n[1]):e})},escapeRegExp:function(e){return e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},insert:function(e,t,n){var r=p.chars(e);return r.splice(~~t,0,""+n),r.join("")},include:function(e,t){return!!~(""+e).indexOf(t)},join:function(){var e=a(arguments);return e.join(e.shift())},lines:function(e){return(""+e).split("\n")},reverse:function(e){return p.chars(e).reverse().join("")},splice:function(e,t,n,r){var i=p.chars(e);return i.splice(~~t,~~n,r),i.join("")},startsWith:function(e,t){return e+="",t+="",e.length>=t.length&&e.substring(0,t.length)===t},endsWith:function(e,t){return e+="",t+="",e.length>=t.length&&e.substring(e.length-t.length)===t},succ:function(e){e+="";var t=p.chars(e);return t.splice(e.length-1,1,String.fromCharCode(e.charCodeAt(e.length-1)+1)),t.join("")},titleize:function(e){return(""+e).replace(/\b./g,function(e){return e.toUpperCase()})},camelize:function(e){return p.trim(e).replace(/[-_\s]+(.)?/g,function(e,t){return t&&t.toUpperCase()})},underscored:function(e){return p.trim(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(e){return p.trim(e).replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase()},classify:function(e){return e+="",p.titleize(e.replace(/_/g," ")).replace(/\s/g,"")},humanize:function(e){return p.capitalize(this.underscored(e).replace(/_id$/,"").replace(/_/g," "))},trim:function(e,n){return e+="",!n&&t?t.call(e):(n=s(n),e.replace(RegExp("^"+n+"+|"+n+"+$","g"),""))},ltrim:function(e,t){return e+="",!t&&r?r.call(e):(t=s(t),e.replace(RegExp("^"+t+"+"),""))},rtrim:function(e,t){return e+="",!t&&n?n.call(e):(t=s(t),e.replace(RegExp(t+"+$"),""))},truncate:function(e,t,n){return e+="",n=n||"...",t=~~t,e.length>t?e.slice(0,t)+n:e},prune:function(e,t,n){e+="",t=~~t,n=null!=n?""+n:"...";var r,i,o=e.replace(/\W/g,function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "});return i=o.charAt(t),r=o.slice(0,t),i&&i.match(/\S/)&&(r=r.replace(/\s\S+$/,"")),r=p.rtrim(r),(r+n).length>e.length?e:e.substring(0,r.length)+n},words:function(e,t){return p.trim(e,t).split(t||/\s+/)},pad:function(e,t,n,r){e+="";var i=0;switch(t=~~t,n?n.length>1&&(n=n.charAt(0)):n=" ",r){case"right":return i=t-e.length,e+o(n,i);case"both":return i=t-e.length,o(n,Math.ceil(i/2))+e+o(n,Math.floor(i/2));default:return i=t-e.length,o(n,i)+e}},lpad:function(e,t,n){return p.pad(e,t,n)},rpad:function(e,t,n){return p.pad(e,t,n,"right")},lrpad:function(e,t,n){return p.pad(e,t,n,"both")},sprintf:f,vsprintf:function(e,t){return t.unshift(e),f.apply(null,t)},toNumber:function(e,t){e+="";var n=i(i(e).toFixed(~~t));return 0!==n||e.match(/^0+$/)?n:Number.NaN},strRight:function(e,t){e+="",t=null!=t?""+t:t;var n=t?e.indexOf(t):-1;return~n?e.slice(n+t.length,e.length):e},strRightBack:function(e,t){e+="",t=null!=t?""+t:t;var n=t?e.lastIndexOf(t):-1;return~n?e.slice(n+t.length,e.length):e},strLeft:function(e,t){e+="",t=null!=t?""+t:t;var n=t?e.indexOf(t):-1;return~n?e.slice(0,n):e},strLeftBack:function(e,t){e+="",t=null!=t?""+t:t;var n=e.lastIndexOf(t);return~n?e.slice(0,n):e},toSentence:function(e,t,n){t||(t=", "),n||(n=" and ");for(var r=e.length,i="",o=0;r>o;o++)i+=e[o],o===r-2?i+=n:r-1>o&&(i+=t);return i},slugify:function(e){var t="ąàáäâãćęèéëêìíïîłńòóöôõùúüûñçżź",n="aaaaaaceeeeeiiiilnooooouuuunczz",r=RegExp(s(t),"g");return e=(""+e).toLowerCase(),e=e.replace(r,function(e){var r=t.indexOf(e);return n.charAt(r)||"-"}),p.trim(e.replace(/[^\w\s-]/g,"").replace(/[-\s]+/g,"-"),"-")},exports:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&!~p.words("include contains reverse").indexOf(t)&&(e[t]=this[t]);return e},repeat:o};p.strip=p.trim,p.lstrip=p.ltrim,p.rstrip=p.rtrim,p.center=p.lrpad,p.rjust=p.lpad,p.ljust=p.rpad,p.contains=p.include,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=p),exports._s=p):"function"==typeof define&&define.amd?define("underscore.string",[],function(){return p}):(e._=e._||{},e._.string=e._.str=p)})(this||window);
/*
 * grunt
 * http://gruntjs.com/
 *
 * Copyright (c) 2012 "Cowboy" Ben Alman
 * Licensed under the MIT license.
 * https://github.com/gruntjs/grunt/blob/master/LICENSE-MIT
 */

function gRequire(e){return grunt[e]=require("./grunt/"+e)}function gExpose(e,t,n){grunt[n||t]=e[t].bind(e)}var path=require("path");require("coffee-script");var grunt=module.exports={},util=gRequire("util");gRequire("template"),gRequire("event");var fail=gRequire("fail"),file=gRequire("file"),option=gRequire("option"),config=gRequire("config"),task=gRequire("task"),log=gRequire("log"),help=gRequire("help");gRequire("cli");var verbose=grunt.verbose=log.verbose;grunt.package=file.readJSON(path.join(__dirname,"../package.json")),grunt.version=grunt.package.version,gExpose(task,"registerTask"),gExpose(task,"registerMultiTask"),gExpose(task,"registerInitTask"),gExpose(task,"renameTask"),gExpose(task,"loadTasks"),gExpose(task,"registerTask"),gExpose(task,"loadNpmTasks"),gExpose(config,"init","initConfig"),gExpose(fail,"warn"),gExpose(fail,"fatal"),process.on("uncaughtException",function(e){fail.fatal(e,fail.code.TASK_FAILURE)}),grunt.tasks=function(e,t,n){option.init(t);var r,i;if(option("version"))return log.writeln("grunt v"+grunt.version),option("verbose")&&(verbose.writeln("Install path: "+path.resolve(__dirname,"..")),grunt.log.muted=!0,grunt.task.init([],{help:!0}),grunt.log.muted=!1,r=Object.keys(grunt.task._tasks).sort(),verbose.writeln("Available tasks: "+r.join(" ")),i=[],Object.keys(grunt.cli.optlist).forEach(function(e){var t=grunt.cli.optlist[e];i.push("--"+(t.negate?"no-":"")+e),t.short&&i.push("-"+t.short)}),verbose.writeln("Available options: "+i.join(" "))),void 0;if(log.initColors(),option("help"))return help.display(),void 0;verbose.header("Initializing").writeflags(option.flags(),"Command-line options");var o=e&&e.length>0;e=task.parseArgs([o?e:"default"]),task.init(e),verbose.writeln(),o||verbose.writeln("No tasks specified, running default tasks."),verbose.writeflags(e,"Running tasks"),task.options({error:function(e){fail.warn(e,fail.code.TASK_FAILURE)},done:function(){fail.report(),n?n():util.exit(0)}}),e.forEach(function(e){task.run(e)}),task.start()};
/*
 * grunt
 * http://gruntjs.com/
 *
 * Copyright (c) 2012 "Cowboy" Ben Alman
 * Licensed under the MIT license.
 * https://github.com/gruntjs/grunt/blob/master/LICENSE-MIT
 */

var grunt=require("../grunt"),template=module.exports={};template.date=require("dateformat"),template.today=function(e){return template.date(new Date,e)};var allDelimiters={};template.addDelimiters=function(e,t,n){var r=allDelimiters[e]={};r.opener=t,r.closer=n;var i=r.opener.replace(/(.)/g,"\\$1"),o="([\\s\\S]+?)"+r.closer.replace(/(.)/g,"\\$1");r.lodash={evaluate:RegExp(i+o,"g"),interpolate:RegExp(i+"="+o,"g"),escape:RegExp(i+"-"+o,"g")}},template.addDelimiters("config","<%","%>"),template.setDelimiters=function(e){var t=allDelimiters[e in allDelimiters?e:"config"];return grunt.util._.templateSettings=t.lodash,t},template.process=function(e,t){t||(t={});var n=template.setDelimiters(t.delimiters),r=Object.create(t.data||grunt.config.data||{});"grunt"in r||(r.grunt=grunt);var i=e;try{for(;e.indexOf(n.opener)>=0&&(e=grunt.util._.template(e,r),e!==i);)i=e}catch(o){"SyntaxError: Unexpected token ILLEGAL"==o+""&&/\n|\r/.test(e)&&grunt.log.errorlns("A special character was detected in this template. Inside template tags, the \\n and \\r special characters must be escaped as \\\\n and \\\\r. (grunt 0.4.0+)"),o.message="An error occurred while processing a template ("+o.message+").",grunt.warn(o,grunt.fail.code.TEMPLATE_ERROR)}return grunt.util.normalizelf(e)};